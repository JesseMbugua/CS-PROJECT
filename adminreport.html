<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Reports - Street Cleanup</title>
  <link rel="stylesheet" href="admin.css">
</head>
<body>
  <div class="dashboard">
    <aside class="sidebar">
      <h2>Admin Panel</h2>
      <ul>
  <li id="manage-users-btn" class="active-dashboard">Manage Users</li>
  <li id="manage-events-btn">Manage Events</li>
  <li id="reports-btn">Reports</li>
</ul>
    </aside>
    <main class="main-content">
      <header>
        <h1>All Reports</h1>
      </header>
      <section class="table-section">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Address</th>
              <th>Description</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="reports-tbody">
            <!-- Reports will be loaded here -->
          </tbody>
        </table>
      </section>
    </main>
  </div>
  <script>
   async function loadReports() {
  const res = await fetch('/api/admin/reports');
  const reports = await res.json();
  const tbody = document.getElementById('reports-tbody');
  tbody.innerHTML = '';
  reports.forEach(report => {
    tbody.innerHTML += `
      <tr>
        <td>${report.id}</td>
        <td>${report.address}</td>
        <td>${report.description}</td>
        <td>
          <select class="status-select" data-id="${report.id}">
            <option value="Unresolved" ${report.status === 'Unresolved' ? 'selected' : ''}>Unresolved</option>
            <option value="Pending" ${report.status === 'Pending' ? 'selected' : ''}>Pending</option>
            <option value="Resolved" ${report.status === 'Resolved' ? 'selected' : ''}>Resolved</option>
          </select>
        </td>
      </tr>
    `;
  });

  // Add event listeners for status changes
  document.querySelectorAll('.status-select').forEach(select => {
    select.addEventListener('change', async function() {
      const id = this.getAttribute('data-id');
      const status = this.value;
      await fetch('/api/admin/report-status', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ id, status })
      });
    });
  });
}
    document.addEventListener('DOMContentLoaded', loadReports);
  </script>
</body>
</html>